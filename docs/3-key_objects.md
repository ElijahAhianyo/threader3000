# Key Objects

[_Documentation generated by Documatic_](https://www.documatic.com)

<!---Documatic-section-threader3000.main-start--->
## threader3000.main

<!---Documatic-section-main-start--->
<!---Documatic-block-threader3000.main-start--->
<details>
	<summary><code>threader3000.main</code> code snippet</summary>

```python
def main():
    socket.setdefaulttimeout(0.3)
    print_lock = threading.Lock()
    discovered_ports = []
    print('-' * 60)
    print('        Threader 3000 - Multi-threaded Port Scanner          ')
    print('                       Version 1.0.7                    ')
    print('                   A project by The Mayor               ')
    print('-' * 60)
    time.sleep(1)
    target = input('Enter your target IP address or URL here: ')
    error = 'Invalid Input'
    try:
        t_ip = socket.gethostbyname(target)
    except (UnboundLocalError, socket.gaierror):
        print('\n[-]Invalid format. Please use a correct IP or web address[-]\n')
        sys.exit()
    print('-' * 60)
    print('Scanning target ' + t_ip)
    print('Time started: ' + str(datetime.now()))
    print('-' * 60)
    t1 = datetime.now()

    def portscan(port):
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        try:
            portx = s.connect((t_ip, port))
            with print_lock:
                print('Port {} is open'.format(port))
                discovered_ports.append(str(port))
            portx.close()
        except (ConnectionRefusedError, AttributeError, OSError):
            pass

    def threader():
        while True:
            worker = q.get()
            portscan(worker)
            q.task_done()
    q = Queue()
    for x in range(200):
        t = threading.Thread(target=threader)
        t.daemon = True
        t.start()
    for worker in range(1, 65536):
        q.put(worker)
    q.join()
    t2 = datetime.now()
    total = t2 - t1
    print('Port scan completed in ' + str(total))
    print('-' * 60)
    print('Threader3000 recommends the following Nmap scan:')
    print('*' * 60)
    print('nmap -p{ports} -sV -sC -T4 -Pn -oA {ip} {ip}'.format(ports=','.join(discovered_ports), ip=target))
    print('*' * 60)
    nmap = 'nmap -p{ports} -sV -sC -T4 -Pn -oA {ip} {ip}'.format(ports=','.join(discovered_ports), ip=target)
    t3 = datetime.now()
    total1 = t3 - t1

    def automate():
        choice = '0'
        while choice == '0':
            print('Would you like to run Nmap or quit to terminal?')
            print('-' * 60)
            print('1 = Run suggested Nmap scan')
            print('2 = Run another Threader3000 scan')
            print('3 = Exit to terminal')
            print('-' * 60)
            choice = input('Option Selection: ')
            if choice == '1':
                try:
                    print(nmap)
                    os.mkdir(target)
                    os.chdir(target)
                    os.system(nmap)
                    t3 = datetime.now()
                    total1 = t3 - t1
                    print('-' * 60)
                    print('Combined scan completed in ' + str(total1))
                    print('Press enter to quit...')
                    input()
                except FileExistsError as e:
                    print(e)
                    exit()
            elif choice == '2':
                main()
            elif choice == '3':
                sys.exit()
            else:
                print('Please make a valid selection')
                automate()
    automate()
```
</details>
<!---Documatic-block-threader3000.main-end--->
<!---Documatic-section-main-end--->

# #
<!---Documatic-section-threader3000.main-end--->

[_Documentation generated by Documatic_](https://www.documatic.com)